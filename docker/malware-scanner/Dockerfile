FROM golang:1.17
LABEL maintainer="SkynetLabs <devs@siasky.net>"

ENV GOOS linux
ENV GOARCH amd64

ARG branch=main

WORKDIR /root

RUN git clone --single-branch --branch ${branch} https://github.com/SkynetLabs/malware-scanner.git && \
    cd malware-scanner && \
    go mod download && \
    make release

ARG SKYNET_DB_HOST=localhost
ARG SKYNET_DB_PORT=27017
ARG SKYNET_DB_USER=username
ARG SKYNET_DB_PASS=password
ARG MALWARE_SCANNER_PORT=4000

ENTRYPOINT ["malware-scanner"]
